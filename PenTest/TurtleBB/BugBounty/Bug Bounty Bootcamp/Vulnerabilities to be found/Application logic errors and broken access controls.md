Those vulnerabilities are different than other ones. Other vulnerabilities are created when there is unexpected behaviors of an application when user inputs something very specific. This vulnerabilities happen when someone bypasses access controls by doing something very specific. One another key difference is that you won't find these just with your technical knowledge. You will have to rely on your creativity more than anything.

### **Application Logic Errors**
Also known as business logic vulnerabilities are ways of using correct flow of application logic that result in a negative consequence  to the organization.

One of the more frequent vulnerability type, which you can encounter is a malfunctioning [[MFA]]. In most cases of implementation of MFA user is asked to authenticate by using password and code that he received through SMS or email. Those MFA implementations are prune to logical error.

For example, let’s say an application implements a three-step login process. First, the application checks the user’s password. Then, it sends an MFA code to the user and verifies it. Finally, the application asks a security question before logging in the user:

Step 1 (Password Check) » Step 2 (MFA) > Step 3 (Security Questions)
A normal authentication flow would look like this:

1. The user visits https://example.com/login/ The application prompts the user for their password, and the user enters it.
2. If the password is correctly entered, the application sends an MFA code to the user's email address and redirects the user to https://example.com/mfa/. Here, the user enters the MFA code.
3. The application checks the MFA code, and if it is correct, redirects the user to https://example.com/security_questions/ There, the application asks the user several security questions and logs in the user if the answers they provided are correct.
Sometimes, though, users can reach step 3 in the authentication process without clearing steps 1 and 2. While the vulnerable application redirects users to step 3 after the completion of step 2, it doesn't verify that step 2 is completed before users are allowed to advance to step 3. In this case, all the attacker has to do is to manipulate the site’s URL and directly request the page of a later stage. 

If the attacker can access step 3 directly he has to guess only one String, which probably has weakest brute-forcing prevention implemented.

Another example. 
Paying for products in ecommerce. 
User can save payment ways and they're verified when saving them or he can pay now with card that isn't saved and that will be verified before payment. If the user pays with saved card his requests gets new parameter:
``saved_card=1
So smart user would try to check if his saved card payments will get verified during every purchase too. If they're not he will try to use new, unsaved card but with saved_card=1 parameter. Now he can pay with unverified cards without saving them essentially making free purchases. At least till the moment someone finds out.

Those kind of logical errors are everywhere, because they cannot be find automatically. They can be present in many ways shapes and forms. There are no many tools that have "intelligence" extension in them that can help them understand logic of the application.

### **Broken access control**
Above example we could also classify as an broken access control. Broken access control happens when access control in application is implemented poorly and can be totally bypassed by attacker. They're very connected with IDORs, because IDORs essentially exist only when there is broken access control.

Applications sometimes neglect or forget to lock up sensitive functionalities such as the admin panels used to monitor the application. Developers may mistakenly assume that users can’t access these functionalities because they aren't linked from the main application, or because they're hidden behind an obscure URL or port. But attackers can often access these admin panels without authentication, if they can locate them. For example, even if the application example.com hides its admin panel behind an obscure URL such as https://example.com/YWRtaW4/admin.php, an attacker might still be able to find it via Google dorks or URL brute-forcing.

Sometimes applications don't implement the same access control mechanisms for each of the various ways of accessing their sensitive functionalities. Say the admin panel is properly secured so that only those with valid admin credentials can access it. But if the request is coming from an internal IP address that the machine trusts, the admin panel won't ask the user to authenticate. In this case, if an attacker can find an SSRF vulnerability that allows them to send internal requests, they can access the admin panel without authentication.

Attackers might also be able to bypass access control by tampering with cookies or request headers if they’re predictable. Let’s say the admin panel doesn’t ask for credentials as long as the user requesting access presents the cookie admin=1 in their HTTP request. All the attacker has to do to bypass this control is to add the cookie admin=1 to their requests.

Finally, another common access control issue occurs when users can force their browsing past the access control points. To understand what this means, let’s say the usual way of accessing example.coms admin panel is via the URL https://example.com/YWRtaW4/admin.php. If you browse to that URL, you'll be prompted to log in with your credentials. After that, you'll be redirected to hitps://example.com/YWRtaW4/dashboard.php, which is where the admin panel resides. Users might be able to browse to https://example.com/YWRtaW4/dashboard.php and directly access the admin panel, without providing credentials, if the application doesn’t implement access control at the dashboard page.


### **Directory Traversal**
Directory Traversal vulnerability happens when thanks to manipulating file paths attacker can browse, modify and execute files to which he shouldn't have access to.
Let's say example.com has functionality, which allows users access to send files. Inputting URL address http://example.com/uploads?file=example.jpeg will make application show example.jpeg from folder uploads of the user that is found under /var/www/uploads/NAME_OF_USER/ folder.

If the application doesn't implement sanitization of input data for file parameter, malicious user can use sequences of ../ to escape upload directory. To access /etc/shadow he can try to do something like this:
http://example.com/upload?file=../../../../../etc/shadow 
Website will go to location of  /var/www/uploads/NAME_OF_USER././../../../../etc/shadow, which will point to the shadow file. If the user serving www site has permissions to read this file attackers can also read it. Attacker can also read many more files like configuration files, console logs, source code etc.

### **How to prevent it**
Best way is to have someone else look at your code. Someone that understands both business logic, knows code and knows what application has to do. Look throughout the application in search of logical errors. Remember to have specific permissions for every file in system. Make sure that access control policies are accurate. Also, make sure that the multiple ways of accessing a service have consistent access control mechanisms. For example, it shouldn’t matter whether the application is accessed via a mobile device, desktop device, or API endpoint. The same authentication requirements, such as MFA, should apply for every individual access point.

### **How to find them**
They're actually the easiest to find. They don't require technical knowledge from you. 

##### First Step
[[Getting intimate with target]] will help you understand what the site is intended to do. Read engineering blogs, documentation etc. The more you understand business needs of application and its architecture the more likely it is that you will find this kind of vulnerability.

When you will read that there is new functionality added, test it out first.

##### Second Step
Intercept requests during browsing of webpages and take a closer look on fragile functionalities.  Take note of how sensitive functionalities and access control are implemented, and how they interact with client requests. For the new payment option you found, what are the requests needed to complete the payment? Do any request parameters indicate the payment type or how much will be charged? When accessing the admin portal at /wp-admin/admin.php, are any special HTTP headers or parameters sent?

##### Third Step
Use your creativity to bypass access control or ways to interfere with logic of the app. Toy with requests and prepare requests that shouldn't be allowed.  If you modify the amount to be charged in a request parameter, will the application still process the transaction while charging you a lower amount? Can you switch the payment type to a gift card even though you don’t have one? Can you access the admin page by adding a special cookie, such as admin=1?

### **Escalating attack**
This actually really depends on the functionality that you broke. Sometimes they're critical on their own and sometimes you will have to find more information using admin panel to gain access to RCE. There is no possible way to foretell your escalation path.

